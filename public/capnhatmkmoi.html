<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Set New Password | My‑T</title>
  <style>
    :root{ --green:#2db400; --text:#111827; --muted:#6b7280; --border:#e5e7eb; --field:#f3f4f6; --radius:14px; }
    *{box-sizing:border-box}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; color:var(--text); background:#fff}
    .bar{background:var(--green); color:#fff; text-align:center; font-weight:900; letter-spacing:.3px; padding:10px 14px}
    .wrap{min-height:calc(100svh - 44px); display:grid; place-items:center; padding:28px}
    .card{width:min(520px,100%); border:1px solid var(--border); border-radius:18px; box-shadow:0 10px 30px rgba(17,24,39,.06); background:#fff}
    .head{padding:16px 18px; font-weight:800}
    .panel{padding:16px}

    .input{display:flex; align-items:center; gap:10px; background:var(--field); border:1px solid var(--border); border-radius:var(--radius); height:50px; padding:0 14px}
    .input input{border:0; outline:none; background:transparent; width:100%; font:inherit}
    .row{display:grid; gap:10px}

    .meter{height:8px; border-radius:999px; background:#e5e7eb; overflow:hidden}
    .meter > div{height:100%; width:0%; transition:width .2s; background:#ef4444}

    .hint{font-size:12px; color:var(--muted)}

    .btn{height:46px; border:none; border-radius:12px; cursor:pointer; font-weight:800}
    .btn-primary{background:var(--green); color:#fff}
    .btn-primary:disabled{opacity:.6}

    .actions{display:grid; gap:10px; padding:0 16px 16px}
  </style>
</head>
<body>
  <div class="bar">Set New Password</div>
  <main class="wrap">
    <section class="card">
      <div class="head">Tạo mật khẩu mới</div>
      <div class="panel">
        <form id="pwForm" class="row" novalidate>
          <label class="input">
            <span>🔒</span>
            <input id="pw1" type="password" placeholder="New password" autocomplete="new-password" required />
            <a href="#" id="toggle1" title="Hiện/ẩn" style="text-decoration:none">👁️</a>
          </label>
          <div class="meter"><div id="meterFill"></div></div>
          <div class="hint" id="meterText">Độ mạnh: —</div>

          <label class="input">
            <span>🔒</span>
            <input id="pw2" type="password" placeholder="Confirm password" autocomplete="new-password" required />
            <a href="#" id="toggle2" title="Hiện/ẩn" style="text-decoration:none">👁️</a>
          </label>
          <div class="hint" id="matchText"></div>
        </form>
      </div>
      <div class="actions">
        <button class="btn btn-primary" id="saveBtn" disabled>Lưu mật khẩu</button>
      </div>
    </section>
  </main>

  <script>
    const pw1 = document.getElementById('pw1');
    const pw2 = document.getElementById('pw2');
    const fill = document.getElementById('meterFill');
    const mText = document.getElementById('meterText');
    const save = document.getElementById('saveBtn');

    function strength(p){
      let s = 0;
      if(p.length>=8) s++;
      if(/[A-Z]/.test(p)) s++;
      if(/[a-z]/.test(p)) s++;
      if(/[0-9]/.test(p)) s++;
      if(/[^A-Za-z0-9]/.test(p)) s++;
      return s; // 0..5
    }

    function render(){
      const s = strength(pw1.value);
      const pct = (s/5)*100; fill.style.width = pct+'%';
      fill.style.background = s<2? '#ef4444' : s<4? '#f59e0b' : '#22c55e';
      const label = ['Rất yếu','Yếu','Trung bình','Khá','Mạnh'][Math.max(0,s-1)] || '—';
      mText.textContent = 'Độ mạnh: ' + label;

      const match = pw1.value && pw1.value === pw2.value;
      document.getElementById('matchText').textContent = match? 'Mật khẩu khớp.' : (pw2.value? 'Chưa khớp.' : '');
      save.disabled = !(s>=3 && match);
    }

    pw1.addEventListener('input', render);
    pw2.addEventListener('input', render);

    document.getElementById('toggle1').addEventListener('click', (e)=>{ e.preventDefault(); pw1.type = pw1.type==='password' ? 'text' : 'password'; });
    document.getElementById('toggle2').addEventListener('click', (e)=>{ e.preventDefault(); pw2.type = pw2.type==='password' ? 'text' : 'password'; });

    save.addEventListener('click', ()=>{
      // TODO: gọi API đổi mật khẩu với token xác thực từ email/SMS
      alert('Đổi mật khẩu thành công (demo). Chuyển về trang đăng nhập.');
      window.location.href = 'dangnhap.html';
    });

    render();
  </script>
</body>
</html>
